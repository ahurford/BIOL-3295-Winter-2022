<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 33 Fri Mar 18: Evolution of body size | BIOL-3295.knit</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 33 Fri Mar 18: Evolution of body size | BIOL-3295.knit" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 33 Fri Mar 18: Evolution of body size | BIOL-3295.knit" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="thurs-mar-17-lab-5-final-project-proposal.html"/>
<link rel="next" href="tues-mar-21-work-on-lab-5final-project-catch-up-day.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Tues Jan 11: Syllabus</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#instructor-information"><i class="fa fa-check"></i><b>1.1</b> Instructor Information</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#course-information"><i class="fa fa-check"></i><b>1.2</b> Course Information</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#method-of-evaluation"><i class="fa fa-check"></i><b>1.3</b> Method of Evaluation</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#additional-policies"><i class="fa fa-check"></i><b>1.4</b> Additional Policies</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#accommodation-of-students-with-disabilities"><i class="fa fa-check"></i><b>1.4.1</b> Accommodation of students with disabilities</a></li>
<li class="chapter" data-level="1.4.2" data-path="index.html"><a href="index.html#academic-misconduct"><i class="fa fa-check"></i><b>1.4.2</b> Academic misconduct</a></li>
<li class="chapter" data-level="1.4.3" data-path="index.html"><a href="index.html#equity-and-diversity"><i class="fa fa-check"></i><b>1.4.3</b> Equity and Diversity</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#additional-supports"><i class="fa fa-check"></i><b>1.5</b> Additional Supports</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#tentative-course-schedule"><i class="fa fa-check"></i><b>1.6</b> Tentative course schedule</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#handing-in-your-work"><i class="fa fa-check"></i><b>1.7</b> Handing in your work</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="index.html"><a href="index.html#figures"><i class="fa fa-check"></i><b>1.7.1</b> Making figures to hand-in</a></li>
<li class="chapter" data-level="1.7.2" data-path="index.html"><a href="index.html#RScript"><i class="fa fa-check"></i><b>1.7.2</b> Writing R scripts to hand-in</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="thurs-jan-13-what-is-a-population.html"><a href="thurs-jan-13-what-is-a-population.html"><i class="fa fa-check"></i><b>2</b> Thurs Jan 13: What is a population?</a>
<ul>
<li class="chapter" data-level="2.1" data-path="thurs-jan-13-what-is-a-population.html"><a href="thurs-jan-13-what-is-a-population.html#questions"><i class="fa fa-check"></i><b>2.1</b> Questions</a></li>
<li class="chapter" data-level="2.2" data-path="thurs-jan-13-what-is-a-population.html"><a href="thurs-jan-13-what-is-a-population.html#resources"><i class="fa fa-check"></i><b>2.2</b> Resources</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="fri-jan-14-exponential-growth-discrete-time.html"><a href="fri-jan-14-exponential-growth-discrete-time.html"><i class="fa fa-check"></i><b>3</b> Fri Jan 14: Exponential growth - discrete time</a>
<ul>
<li class="chapter" data-level="3.1" data-path="fri-jan-14-exponential-growth-discrete-time.html"><a href="fri-jan-14-exponential-growth-discrete-time.html#required-reading"><i class="fa fa-check"></i><b>3.1</b> Required reading</a></li>
<li class="chapter" data-level="3.2" data-path="fri-jan-14-exponential-growth-discrete-time.html"><a href="fri-jan-14-exponential-growth-discrete-time.html#questions-1"><i class="fa fa-check"></i><b>3.2</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="PE1.html"><a href="PE1.html"><i class="fa fa-check"></i><b>4</b> Tues Jan 18: Exponential growth - discrete time 2</a>
<ul>
<li class="chapter" data-level="4.1" data-path="PE1.html"><a href="PE1.html#required-reading-1"><i class="fa fa-check"></i><b>4.1</b> Required reading</a></li>
<li class="chapter" data-level="4.2" data-path="PE1.html"><a href="PE1.html#questions-2"><i class="fa fa-check"></i><b>4.2</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="PE3.html"><a href="PE3.html"><i class="fa fa-check"></i><b>5</b> Thurs Jan 20: Exponential growth - discrete time 3</a>
<ul>
<li class="chapter" data-level="5.1" data-path="PE3.html"><a href="PE3.html#required-reading-2"><i class="fa fa-check"></i><b>5.1</b> Required reading</a></li>
<li class="chapter" data-level="5.2" data-path="PE3.html"><a href="PE3.html#questions-3"><i class="fa fa-check"></i><b>5.2</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="thurs-jan-20-lab-1-introduction-to-r-.html"><a href="thurs-jan-20-lab-1-introduction-to-r-.html"><i class="fa fa-check"></i><b>6</b> Thurs Jan 20: LAB 1 - Introduction to R.</a></li>
<li class="chapter" data-level="7" data-path="fri-jan-21-exponential-growth-continuous-time.html"><a href="fri-jan-21-exponential-growth-continuous-time.html"><i class="fa fa-check"></i><b>7</b> Fri Jan 21: Exponential growth - continuous time</a>
<ul>
<li class="chapter" data-level="7.1" data-path="fri-jan-21-exponential-growth-continuous-time.html"><a href="fri-jan-21-exponential-growth-continuous-time.html#required-reading-3"><i class="fa fa-check"></i><b>7.1</b> Required reading</a></li>
<li class="chapter" data-level="7.2" data-path="fri-jan-21-exponential-growth-continuous-time.html"><a href="fri-jan-21-exponential-growth-continuous-time.html#discrete-or-continuous-time-formulations"><i class="fa fa-check"></i><b>7.2</b> Discrete or continuous time formulations</a></li>
<li class="chapter" data-level="7.3" data-path="fri-jan-21-exponential-growth-continuous-time.html"><a href="fri-jan-21-exponential-growth-continuous-time.html#questions-4"><i class="fa fa-check"></i><b>7.3</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="tues-jan-25-exponential-growth-continuous-time.html"><a href="tues-jan-25-exponential-growth-continuous-time.html"><i class="fa fa-check"></i><b>8</b> Tues Jan 25: Exponential growth - continuous time</a>
<ul>
<li class="chapter" data-level="8.1" data-path="tues-jan-25-exponential-growth-continuous-time.html"><a href="tues-jan-25-exponential-growth-continuous-time.html#required-reading-4"><i class="fa fa-check"></i><b>8.1</b> Required reading</a></li>
<li class="chapter" data-level="8.2" data-path="tues-jan-25-exponential-growth-continuous-time.html"><a href="tues-jan-25-exponential-growth-continuous-time.html#questions-5"><i class="fa fa-check"></i><b>8.2</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="thurs-jan-27-density-dependence-and-logistic-growth.html"><a href="thurs-jan-27-density-dependence-and-logistic-growth.html"><i class="fa fa-check"></i><b>9</b> Thurs Jan 27: Density dependence and logistic growth</a>
<ul>
<li class="chapter" data-level="9.1" data-path="thurs-jan-27-density-dependence-and-logistic-growth.html"><a href="thurs-jan-27-density-dependence-and-logistic-growth.html#required-reading-5"><i class="fa fa-check"></i><b>9.1</b> Required reading</a></li>
<li class="chapter" data-level="9.2" data-path="thurs-jan-27-density-dependence-and-logistic-growth.html"><a href="thurs-jan-27-density-dependence-and-logistic-growth.html#questions-6"><i class="fa fa-check"></i><b>9.2</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="fri-jan-28-density-dependence-and-logistic-growth.html"><a href="fri-jan-28-density-dependence-and-logistic-growth.html"><i class="fa fa-check"></i><b>10</b> Fri Jan 28: Density dependence and logistic growth</a>
<ul>
<li class="chapter" data-level="10.1" data-path="fri-jan-28-density-dependence-and-logistic-growth.html"><a href="fri-jan-28-density-dependence-and-logistic-growth.html#required-reading-6"><i class="fa fa-check"></i><b>10.1</b> Required reading</a></li>
<li class="chapter" data-level="10.2" data-path="fri-jan-28-density-dependence-and-logistic-growth.html"><a href="fri-jan-28-density-dependence-and-logistic-growth.html#questions-7"><i class="fa fa-check"></i><b>10.2</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="tues-feb-1-density-dependence-and-logistic-growth.html"><a href="tues-feb-1-density-dependence-and-logistic-growth.html"><i class="fa fa-check"></i><b>11</b> Tues Feb 1: Density dependence and logistic growth</a>
<ul>
<li class="chapter" data-level="11.1" data-path="tues-feb-1-density-dependence-and-logistic-growth.html"><a href="tues-feb-1-density-dependence-and-logistic-growth.html#required-reading-7"><i class="fa fa-check"></i><b>11.1</b> Required reading</a></li>
<li class="chapter" data-level="11.2" data-path="tues-feb-1-density-dependence-and-logistic-growth.html"><a href="tues-feb-1-density-dependence-and-logistic-growth.html#questions-8"><i class="fa fa-check"></i><b>11.2</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="thurs-feb-3-density-yield-and-the-discrete-time-density-dependence.html"><a href="thurs-feb-3-density-yield-and-the-discrete-time-density-dependence.html"><i class="fa fa-check"></i><b>12</b> Thurs Feb 3: Density-yield and the discrete time density dependence</a>
<ul>
<li class="chapter" data-level="12.1" data-path="thurs-feb-3-density-yield-and-the-discrete-time-density-dependence.html"><a href="thurs-feb-3-density-yield-and-the-discrete-time-density-dependence.html#required-reading-8"><i class="fa fa-check"></i><b>12.1</b> Required reading</a></li>
<li class="chapter" data-level="12.2" data-path="thurs-feb-3-density-yield-and-the-discrete-time-density-dependence.html"><a href="thurs-feb-3-density-yield-and-the-discrete-time-density-dependence.html#questions-9"><i class="fa fa-check"></i><b>12.2</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="lab-2.html"><a href="lab-2.html"><i class="fa fa-check"></i><b>13</b> Thurs Feb 3: LAB 2 - Logistic and exponential growth</a>
<ul>
<li class="chapter" data-level="13.1" data-path="lab-2.html"><a href="lab-2.html#change-in-population-size-and-population-size"><i class="fa fa-check"></i><b>13.1</b> Change in population size, and population size</a></li>
<li class="chapter" data-level="13.2" data-path="lab-2.html"><a href="lab-2.html#what-is-an-ordinary-differential-equation"><i class="fa fa-check"></i><b>13.2</b> What is an ordinary differential equation?</a></li>
<li class="chapter" data-level="13.3" data-path="lab-2.html"><a href="lab-2.html#numerically-integrating-an-ordinary-differential-equation-in-r"><i class="fa fa-check"></i><b>13.3</b> Numerically integrating an ordinary differential equation in R</a></li>
<li class="chapter" data-level="13.4" data-path="lab-2.html"><a href="lab-2.html#writing-custom-functions"><i class="fa fa-check"></i><b>13.4</b> Writing custom functions</a></li>
<li class="chapter" data-level="13.5" data-path="lab-2.html"><a href="lab-2.html#questions-10"><i class="fa fa-check"></i><b>13.5</b> Questions</a></li>
<li class="chapter" data-level="13.6" data-path="lab-2.html"><a href="lab-2.html#writing-the-func-argument-for-ode"><i class="fa fa-check"></i><b>13.6</b> Writing the func argument for ode()</a></li>
<li class="chapter" data-level="13.7" data-path="lab-2.html"><a href="lab-2.html#questions-11"><i class="fa fa-check"></i><b>13.7</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="fri-feb-4-age-structured-population-dynamics.html"><a href="fri-feb-4-age-structured-population-dynamics.html"><i class="fa fa-check"></i><b>14</b> Fri Feb 4: Age-structured population dynamics</a>
<ul>
<li class="chapter" data-level="14.1" data-path="fri-feb-4-age-structured-population-dynamics.html"><a href="fri-feb-4-age-structured-population-dynamics.html#required-reading-9"><i class="fa fa-check"></i><b>14.1</b> Required Reading</a></li>
<li class="chapter" data-level="14.2" data-path="fri-feb-4-age-structured-population-dynamics.html"><a href="fri-feb-4-age-structured-population-dynamics.html#questions-12"><i class="fa fa-check"></i><b>14.2</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="tues-feb-8-age-structured-population-dynamics.html"><a href="tues-feb-8-age-structured-population-dynamics.html"><i class="fa fa-check"></i><b>15</b> Tues Feb 8: Age-structured population dynamics</a>
<ul>
<li class="chapter" data-level="15.1" data-path="tues-feb-8-age-structured-population-dynamics.html"><a href="tues-feb-8-age-structured-population-dynamics.html#required-reading-10"><i class="fa fa-check"></i><b>15.1</b> Required Reading</a></li>
<li class="chapter" data-level="15.2" data-path="tues-feb-8-age-structured-population-dynamics.html"><a href="tues-feb-8-age-structured-population-dynamics.html#questions-13"><i class="fa fa-check"></i><b>15.2</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="thurs-feb-10-age-structured-population-dynamics.html"><a href="thurs-feb-10-age-structured-population-dynamics.html"><i class="fa fa-check"></i><b>16</b> Thurs Feb 10: Age-structured population dynamics</a>
<ul>
<li class="chapter" data-level="16.1" data-path="thurs-feb-10-age-structured-population-dynamics.html"><a href="thurs-feb-10-age-structured-population-dynamics.html#required-reading-11"><i class="fa fa-check"></i><b>16.1</b> Required Reading</a></li>
<li class="chapter" data-level="16.2" data-path="thurs-feb-10-age-structured-population-dynamics.html"><a href="thurs-feb-10-age-structured-population-dynamics.html#questions-14"><i class="fa fa-check"></i><b>16.2</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="fri-feb-11-age-structured-population-dynamics.html"><a href="fri-feb-11-age-structured-population-dynamics.html"><i class="fa fa-check"></i><b>17</b> Fri Feb 11: Age-structured population dynamics</a>
<ul>
<li class="chapter" data-level="17.1" data-path="fri-feb-11-age-structured-population-dynamics.html"><a href="fri-feb-11-age-structured-population-dynamics.html#required-reading-12"><i class="fa fa-check"></i><b>17.1</b> Required Reading</a></li>
<li class="chapter" data-level="17.2" data-path="fri-feb-11-age-structured-population-dynamics.html"><a href="fri-feb-11-age-structured-population-dynamics.html#questions-15"><i class="fa fa-check"></i><b>17.2</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="tues-feb-15-age-structured-population-dynamics.html"><a href="tues-feb-15-age-structured-population-dynamics.html"><i class="fa fa-check"></i><b>18</b> Tues Feb 15: Age-structured population dynamics</a>
<ul>
<li class="chapter" data-level="18.1" data-path="tues-feb-15-age-structured-population-dynamics.html"><a href="tues-feb-15-age-structured-population-dynamics.html#required-reading-13"><i class="fa fa-check"></i><b>18.1</b> Required Reading</a></li>
<li class="chapter" data-level="18.2" data-path="tues-feb-15-age-structured-population-dynamics.html"><a href="tues-feb-15-age-structured-population-dynamics.html#questions-16"><i class="fa fa-check"></i><b>18.2</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="thurs-feb-17-age-structured-population-dynamics.html"><a href="thurs-feb-17-age-structured-population-dynamics.html"><i class="fa fa-check"></i><b>19</b> Thurs Feb 17: Age-structured population dynamics</a></li>
<li class="chapter" data-level="20" data-path="lab-3-thurs-feb-17-computational-analysis-of-yellow-columbines-aquilegia-chrysantha-stage-structured-model.html"><a href="lab-3-thurs-feb-17-computational-analysis-of-yellow-columbines-aquilegia-chrysantha-stage-structured-model.html"><i class="fa fa-check"></i><b>20</b> LAB 3 - Thurs Feb 17: Computational analysis of yellow columbines (Aquilegia chrysantha) stage-structured model</a></li>
<li class="chapter" data-level="21" data-path="midterm.html"><a href="midterm.html"><i class="fa fa-check"></i><b>21</b> MIDTERM</a>
<ul>
<li class="chapter" data-level="21.1" data-path="midterm.html"><a href="midterm.html#chapter-1-in-vandermeer-and-goldberg"><i class="fa fa-check"></i><b>21.1</b> Chapter 1 in Vandermeer and Goldberg</a></li>
<li class="chapter" data-level="21.2" data-path="midterm.html"><a href="midterm.html#chapter-6-in-sherratt-and-wikinson"><i class="fa fa-check"></i><b>21.2</b> Chapter 6 in Sherratt and Wikinson</a></li>
<li class="chapter" data-level="21.3" data-path="midterm.html"><a href="midterm.html#stage-structured-population-dynamics"><i class="fa fa-check"></i><b>21.3</b> Stage-structured population dynamics</a></li>
<li class="chapter" data-level="21.4" data-path="midterm.html"><a href="midterm.html#kendall-et-al.-2019"><i class="fa fa-check"></i><b>21.4</b> Kendall et al. 2019</a></li>
<li class="chapter" data-level="21.5" data-path="midterm.html"><a href="midterm.html#numerical-solutions-of-an-ordinary-differential-equation."><i class="fa fa-check"></i><b>21.5</b> Numerical solutions of an ordinary differential equation.</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="fri-feb-18-density-dependence-in-age-structured-models.html"><a href="fri-feb-18-density-dependence-in-age-structured-models.html"><i class="fa fa-check"></i><b>22</b> Fri Feb 18: Density dependence in age-structured models</a>
<ul>
<li class="chapter" data-level="22.1" data-path="fri-feb-18-density-dependence-in-age-structured-models.html"><a href="fri-feb-18-density-dependence-in-age-structured-models.html#required-reading-14"><i class="fa fa-check"></i><b>22.1</b> Required Reading</a></li>
<li class="chapter" data-level="22.2" data-path="fri-feb-18-density-dependence-in-age-structured-models.html"><a href="fri-feb-18-density-dependence-in-age-structured-models.html#questions-17"><i class="fa fa-check"></i><b>22.2</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="tues-mar-1-evolutionary-ecology.html"><a href="tues-mar-1-evolutionary-ecology.html"><i class="fa fa-check"></i><b>23</b> Tues Mar 1: Evolutionary ecology</a>
<ul>
<li class="chapter" data-level="23.1" data-path="tues-mar-1-evolutionary-ecology.html"><a href="tues-mar-1-evolutionary-ecology.html#required-reading-15"><i class="fa fa-check"></i><b>23.1</b> Required Reading</a></li>
<li class="chapter" data-level="23.2" data-path="tues-mar-1-evolutionary-ecology.html"><a href="tues-mar-1-evolutionary-ecology.html#questions-18"><i class="fa fa-check"></i><b>23.2</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="thursday-mar-3-evolutionary-ecology.html"><a href="thursday-mar-3-evolutionary-ecology.html"><i class="fa fa-check"></i><b>24</b> Thursday Mar 3: Evolutionary ecology</a>
<ul>
<li class="chapter" data-level="24.1" data-path="thursday-mar-3-evolutionary-ecology.html"><a href="thursday-mar-3-evolutionary-ecology.html#required-readings"><i class="fa fa-check"></i><b>24.1</b> Required Readings</a></li>
<li class="chapter" data-level="24.2" data-path="thursday-mar-3-evolutionary-ecology.html"><a href="thursday-mar-3-evolutionary-ecology.html#questions-19"><i class="fa fa-check"></i><b>24.2</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="thurs-mar-3-lab-4-data-manipulation.html"><a href="thurs-mar-3-lab-4-data-manipulation.html"><i class="fa fa-check"></i><b>25</b> Thurs Mar 3: LAB 4 - Data manipulation</a></li>
<li class="chapter" data-level="26" data-path="fri-mar-4-evolutionary-ecology.html"><a href="fri-mar-4-evolutionary-ecology.html"><i class="fa fa-check"></i><b>26</b> Fri Mar 4: Evolutionary ecology</a>
<ul>
<li class="chapter" data-level="26.1" data-path="fri-mar-4-evolutionary-ecology.html"><a href="fri-mar-4-evolutionary-ecology.html#required-reading-16"><i class="fa fa-check"></i><b>26.1</b> Required Reading</a></li>
<li class="chapter" data-level="26.2" data-path="fri-mar-4-evolutionary-ecology.html"><a href="fri-mar-4-evolutionary-ecology.html#questions-20"><i class="fa fa-check"></i><b>26.2</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="tues-mar-8-evolutionary-ecology.html"><a href="tues-mar-8-evolutionary-ecology.html"><i class="fa fa-check"></i><b>27</b> Tues Mar 8: Evolutionary ecology</a>
<ul>
<li class="chapter" data-level="27.1" data-path="tues-mar-8-evolutionary-ecology.html"><a href="tues-mar-8-evolutionary-ecology.html#required-reading-17"><i class="fa fa-check"></i><b>27.1</b> Required Reading</a></li>
<li class="chapter" data-level="27.2" data-path="tues-mar-8-evolutionary-ecology.html"><a href="tues-mar-8-evolutionary-ecology.html#questions-21"><i class="fa fa-check"></i><b>27.2</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="thurs-mar-10-evolutionary-ecology.html"><a href="thurs-mar-10-evolutionary-ecology.html"><i class="fa fa-check"></i><b>28</b> Thurs Mar 10: Evolutionary ecology</a>
<ul>
<li class="chapter" data-level="28.1" data-path="thurs-mar-10-evolutionary-ecology.html"><a href="thurs-mar-10-evolutionary-ecology.html#relevant-reading"><i class="fa fa-check"></i><b>28.1</b> Relevant Reading</a></li>
<li class="chapter" data-level="28.2" data-path="thurs-mar-10-evolutionary-ecology.html"><a href="thurs-mar-10-evolutionary-ecology.html#questions-22"><i class="fa fa-check"></i><b>28.2</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="29" data-path="fri-mar-11-evolutionary-ecology.html"><a href="fri-mar-11-evolutionary-ecology.html"><i class="fa fa-check"></i><b>29</b> Fri Mar 11: Evolutionary ecology</a>
<ul>
<li class="chapter" data-level="29.1" data-path="fri-mar-11-evolutionary-ecology.html"><a href="fri-mar-11-evolutionary-ecology.html#questions-23"><i class="fa fa-check"></i><b>29.1</b> Questions</a></li>
<li class="chapter" data-level="29.2" data-path="fri-mar-11-evolutionary-ecology.html"><a href="fri-mar-11-evolutionary-ecology.html#some-relevant-textbooks"><i class="fa fa-check"></i><b>29.2</b> Some relevant textbooks</a></li>
</ul></li>
<li class="chapter" data-level="30" data-path="tues-mar-15-evolutionary-ecology.html"><a href="tues-mar-15-evolutionary-ecology.html"><i class="fa fa-check"></i><b>30</b> Tues Mar 15: Evolutionary ecology</a>
<ul>
<li class="chapter" data-level="30.1" data-path="tues-mar-15-evolutionary-ecology.html"><a href="tues-mar-15-evolutionary-ecology.html#required-readingviewing"><i class="fa fa-check"></i><b>30.1</b> Required Reading/Viewing</a></li>
<li class="chapter" data-level="30.2" data-path="tues-mar-15-evolutionary-ecology.html"><a href="tues-mar-15-evolutionary-ecology.html#questions-24"><i class="fa fa-check"></i><b>30.2</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="31" data-path="thurs-mar-17-life-history-trade-offs.html"><a href="thurs-mar-17-life-history-trade-offs.html"><i class="fa fa-check"></i><b>31</b> Thurs Mar 17: Life history trade-offs</a>
<ul>
<li class="chapter" data-level="31.1" data-path="thurs-mar-17-life-history-trade-offs.html"><a href="thurs-mar-17-life-history-trade-offs.html#questions-25"><i class="fa fa-check"></i><b>31.1</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="32" data-path="thurs-mar-17-lab-5-final-project-proposal.html"><a href="thurs-mar-17-lab-5-final-project-proposal.html"><i class="fa fa-check"></i><b>32</b> Thurs Mar 17: LAB 5 - final project proposal</a></li>
<li class="chapter" data-level="33" data-path="fri-mar-18-evolution-of-body-size.html"><a href="fri-mar-18-evolution-of-body-size.html"><i class="fa fa-check"></i><b>33</b> Fri Mar 18: Evolution of body size</a>
<ul>
<li class="chapter" data-level="33.1" data-path="fri-mar-18-evolution-of-body-size.html"><a href="fri-mar-18-evolution-of-body-size.html#questions-26"><i class="fa fa-check"></i><b>33.1</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="34" data-path="tues-mar-21-work-on-lab-5final-project-catch-up-day.html"><a href="tues-mar-21-work-on-lab-5final-project-catch-up-day.html"><i class="fa fa-check"></i><b>34</b> Tues Mar 21: Work on Lab 5/final project (catch-up day)</a></li>
<li class="chapter" data-level="35" data-path="thurs-mar-24-evolution-of-senescence.html"><a href="thurs-mar-24-evolution-of-senescence.html"><i class="fa fa-check"></i><b>35</b> Thurs Mar 24: Evolution of senescence</a>
<ul>
<li class="chapter" data-level="35.1" data-path="thurs-mar-24-evolution-of-senescence.html"><a href="thurs-mar-24-evolution-of-senescence.html#required-reading-listening"><i class="fa fa-check"></i><b>35.1</b> Required reading &amp; listening</a></li>
<li class="chapter" data-level="35.2" data-path="thurs-mar-24-evolution-of-senescence.html"><a href="thurs-mar-24-evolution-of-senescence.html#questions-27"><i class="fa fa-check"></i><b>35.2</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="36" data-path="fri-mar-25-evolution-of-senescence.html"><a href="fri-mar-25-evolution-of-senescence.html"><i class="fa fa-check"></i><b>36</b> Fri Mar 25: Evolution of senescence</a>
<ul>
<li class="chapter" data-level="36.1" data-path="fri-mar-25-evolution-of-senescence.html"><a href="fri-mar-25-evolution-of-senescence.html#required-reading-18"><i class="fa fa-check"></i><b>36.1</b> Required reading</a></li>
<li class="chapter" data-level="36.2" data-path="fri-mar-25-evolution-of-senescence.html"><a href="fri-mar-25-evolution-of-senescence.html#hand-in-note-you-will-have-time-on-tuesday-to-complete-this-exercise-too"><i class="fa fa-check"></i><b>36.2</b> HAND-IN (Note you will have time on Tuesday to complete this exercise too)</a></li>
</ul></li>
<li class="chapter" data-level="37" data-path="tues-mar-29-catch-up-day.html"><a href="tues-mar-29-catch-up-day.html"><i class="fa fa-check"></i><b>37</b> Tues Mar 29: Catch-up day</a></li>
<li class="chapter" data-level="38" data-path="thurs-mar-31-rmarkdown.html"><a href="thurs-mar-31-rmarkdown.html"><i class="fa fa-check"></i><b>38</b> Thurs Mar 31: Rmarkdown</a>
<ul>
<li class="chapter" data-level="38.1" data-path="thurs-mar-31-rmarkdown.html"><a href="thurs-mar-31-rmarkdown.html#questions-28"><i class="fa fa-check"></i><b>38.1</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="39" data-path="thurs-mar-31-lab-6-annotated-bibliography.html"><a href="thurs-mar-31-lab-6-annotated-bibliography.html"><i class="fa fa-check"></i><b>39</b> Thurs Mar 31: LAB 6 - Annotated bibliography</a></li>
<li class="chapter" data-level="40" data-path="tues-april-5-catch-up-day.html"><a href="tues-april-5-catch-up-day.html"><i class="fa fa-check"></i><b>40</b> Tues April 5: Catch-up day</a></li>
<li class="chapter" data-level="41" data-path="fri-april-1-rmarkdown.html"><a href="fri-april-1-rmarkdown.html"><i class="fa fa-check"></i><b>41</b> Fri April 1: Rmarkdown</a>
<ul>
<li class="chapter" data-level="41.1" data-path="fri-april-1-rmarkdown.html"><a href="fri-april-1-rmarkdown.html#questions-29"><i class="fa fa-check"></i><b>41.1</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="42" data-path="final.html"><a href="final.html"><i class="fa fa-check"></i><b>42</b> Final project</a>
<ul>
<li class="chapter" data-level="42.1" data-path="final.html"><a href="final.html#option-1-review-paper"><i class="fa fa-check"></i><b>42.1</b> Option 1: Review paper</a></li>
<li class="chapter" data-level="42.2" data-path="final.html"><a href="final.html#option-2-analysis"><i class="fa fa-check"></i><b>42.2</b> Option 2: Analysis</a></li>
<li class="chapter" data-level="42.3" data-path="final.html"><a href="final.html#how-to-read-scientific-papers"><i class="fa fa-check"></i><b>42.3</b> How to read scientific papers</a></li>
<li class="chapter" data-level="42.4" data-path="final.html"><a href="final.html#grading-rubric-both-review-and-analysis-55-marks"><i class="fa fa-check"></i><b>42.4</b> Grading Rubric: Both Review and Analysis [55 marks]</a>
<ul>
<li class="chapter" data-level="42.4.1" data-path="final.html"><a href="final.html#review"><i class="fa fa-check"></i><b>42.4.1</b> Grading Rubric: Review only [55 marks]</a></li>
<li class="chapter" data-level="42.4.2" data-path="final.html"><a href="final.html#grading-rubric-analysis-only-55-marks"><i class="fa fa-check"></i><b>42.4.2</b> Grading Rubric: Analysis only [55 marks]</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="fri-mar-18-evolution-of-body-size" class="section level1" number="33">
<h1><span class="header-section-number">Chapter 33</span> Fri Mar 18: Evolution of body size</h1>
<p>DUE DATE: Thurs Mar 25.</p>
<p>The code below follows up on the previous lecture. We will investigate the evolutionary dynamics of <em>Drosphohila</em> using a simulation. You should copy and past the code into an R script. Read the comments and run the R script.</p>
<div id="questions-26" class="section level2" number="33.1">
<h2><span class="header-section-number">33.1</span> Questions</h2>
<ol style="list-style-type: decimal">
<li><p>The script produces 3 graphs. Hand in all these graphs. You should change at least one variable or parameter in the code from the default settings, while still producing a graph that illustrates the dominance of the genotype that is expected to have higest fitness based on <a href="https://ebookcentral.proquest.com/lib/mun/detail.action?docID=430289">Fox et al., beginning p107</a> [1 mark]</p></li>
<li><p>Explain in your own words the simulation rules that determine how gene frequencies change over time. Specifically,</p></li>
</ol>
<ul>
<li>Does the population change in size over time?</li>
<li>How many births and deaths occur in each time step?</li>
<li>What determines the chance of death or birth for an individual?</li>
</ul>
<p>[2 marks]</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="fri-mar-18-evolution-of-body-size.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># EVOLUTION OF AGE AND SIZE AT MATURITY IN DROSOPHILA</span></span>
<span id="cb18-2"><a href="fri-mar-18-evolution-of-body-size.html#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co">#__________________________</span></span>
<span id="cb18-3"><a href="fri-mar-18-evolution-of-body-size.html#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="fri-mar-18-evolution-of-body-size.html#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Based on the section beginning on p107 of Fox et al. Evolutionary Ecology.</span></span>
<span id="cb18-5"><a href="fri-mar-18-evolution-of-body-size.html#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co"># https://ebookcentral.proquest.com/lib/mun/detail.action?docID=430289</span></span>
<span id="cb18-6"><a href="fri-mar-18-evolution-of-body-size.html#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="fri-mar-18-evolution-of-body-size.html#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove all objects from the workspace: usually start with this</span></span>
<span id="cb18-8"><a href="fri-mar-18-evolution-of-body-size.html#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb18-9"><a href="fri-mar-18-evolution-of-body-size.html#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="fri-mar-18-evolution-of-body-size.html#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Load a package that provides a color palette</span></span>
<span id="cb18-11"><a href="fri-mar-18-evolution-of-body-size.html#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co"># You&#39;ll need to install this</span></span>
<span id="cb18-12"><a href="fri-mar-18-evolution-of-body-size.html#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(viridis)</span></code></pre></div>
<pre><code>## Loading required package: viridis</code></pre>
<pre><code>## Loading required package: viridisLite</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="fri-mar-18-evolution-of-body-size.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The number of time steps to run the simulation</span></span>
<span id="cb21-2"><a href="fri-mar-18-evolution-of-body-size.html#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># You can change 100 to a different number if you would like</span></span>
<span id="cb21-3"><a href="fri-mar-18-evolution-of-body-size.html#cb21-3" aria-hidden="true" tabindex="-1"></a>total.time <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb21-4"><a href="fri-mar-18-evolution-of-body-size.html#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="fri-mar-18-evolution-of-body-size.html#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Larval mortality rate</span></span>
<span id="cb21-6"><a href="fri-mar-18-evolution-of-body-size.html#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------</span></span>
<span id="cb21-7"><a href="fri-mar-18-evolution-of-body-size.html#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co"># To figure out that the larval mortality rate was 0.1 individuals per time,</span></span>
<span id="cb21-8"><a href="fri-mar-18-evolution-of-body-size.html#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co"># I tried to reproduce Figure 8.2 from Fox et al: I tried different values of</span></span>
<span id="cb21-9"><a href="fri-mar-18-evolution-of-body-size.html#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co"># l0 until I got a graph that gave reasonable &quot;Survival from egg to adult&quot;</span></span>
<span id="cb21-10"><a href="fri-mar-18-evolution-of-body-size.html#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co"># probabilities as a function of thorax length (see below)</span></span>
<span id="cb21-11"><a href="fri-mar-18-evolution-of-body-size.html#cb21-11" aria-hidden="true" tabindex="-1"></a>l0 <span class="ot">=</span> .<span class="dv">1</span></span>
<span id="cb21-12"><a href="fri-mar-18-evolution-of-body-size.html#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="fri-mar-18-evolution-of-body-size.html#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Adult mortality rate</span></span>
<span id="cb21-14"><a href="fri-mar-18-evolution-of-body-size.html#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------</span></span>
<span id="cb21-15"><a href="fri-mar-18-evolution-of-body-size.html#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="co"># I couldn&#39;t find any information on the adult mortality rate so I just</span></span>
<span id="cb21-16"><a href="fri-mar-18-evolution-of-body-size.html#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="co"># guessed that adult mortality was 1/2 larval mortality. You could change</span></span>
<span id="cb21-17"><a href="fri-mar-18-evolution-of-body-size.html#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="co"># this number, but I&#39;d expect that adult mortality is less than larval.</span></span>
<span id="cb21-18"><a href="fri-mar-18-evolution-of-body-size.html#cb21-18" aria-hidden="true" tabindex="-1"></a>l1 <span class="ot">=</span> l0<span class="sc">*</span><span class="fl">0.5</span></span>
<span id="cb21-19"><a href="fri-mar-18-evolution-of-body-size.html#cb21-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-20"><a href="fri-mar-18-evolution-of-body-size.html#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Population size</span></span>
<span id="cb21-21"><a href="fri-mar-18-evolution-of-body-size.html#cb21-21" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------</span></span>
<span id="cb21-22"><a href="fri-mar-18-evolution-of-body-size.html#cb21-22" aria-hidden="true" tabindex="-1"></a><span class="co"># This simulation considers evolution in a population that,</span></span>
<span id="cb21-23"><a href="fri-mar-18-evolution-of-body-size.html#cb21-23" aria-hidden="true" tabindex="-1"></a><span class="co"># for the most part, doesn&#39;t change in size. The population size should be relatively</span></span>
<span id="cb21-24"><a href="fri-mar-18-evolution-of-body-size.html#cb21-24" aria-hidden="true" tabindex="-1"></a><span class="co"># large or the evolutionary outcome will be affected by genetic drift.</span></span>
<span id="cb21-25"><a href="fri-mar-18-evolution-of-body-size.html#cb21-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Although, Fox et al. 2001 states that their results apply to population growth with</span></span>
<span id="cb21-26"><a href="fri-mar-18-evolution-of-body-size.html#cb21-26" aria-hidden="true" tabindex="-1"></a><span class="co"># no density dependence, computation will become very slow if the number of</span></span>
<span id="cb21-27"><a href="fri-mar-18-evolution-of-body-size.html#cb21-27" aria-hidden="true" tabindex="-1"></a><span class="co"># individuals is allowed to become very large. To avoid this we assume a fixed population</span></span>
<span id="cb21-28"><a href="fri-mar-18-evolution-of-body-size.html#cb21-28" aria-hidden="true" tabindex="-1"></a><span class="co"># size with one birth and one death in a time step.</span></span>
<span id="cb21-29"><a href="fri-mar-18-evolution-of-body-size.html#cb21-29" aria-hidden="true" tabindex="-1"></a>Popn.Size<span class="ot">=</span><span class="dv">1000</span></span>
<span id="cb21-30"><a href="fri-mar-18-evolution-of-body-size.html#cb21-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-31"><a href="fri-mar-18-evolution-of-body-size.html#cb21-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Genotypes</span></span>
<span id="cb21-32"><a href="fri-mar-18-evolution-of-body-size.html#cb21-32" aria-hidden="true" tabindex="-1"></a><span class="co">#----------</span></span>
<span id="cb21-33"><a href="fri-mar-18-evolution-of-body-size.html#cb21-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a list of gentoypes/phenotypes that are present in the population</span></span>
<span id="cb21-34"><a href="fri-mar-18-evolution-of-body-size.html#cb21-34" aria-hidden="true" tabindex="-1"></a><span class="co"># The list of numbers below is the thorax size in millimeters. The list below</span></span>
<span id="cb21-35"><a href="fri-mar-18-evolution-of-body-size.html#cb21-35" aria-hidden="true" tabindex="-1"></a><span class="co"># considers 3 different genotypes, which correspond to thorax lengths of</span></span>
<span id="cb21-36"><a href="fri-mar-18-evolution-of-body-size.html#cb21-36" aria-hidden="true" tabindex="-1"></a><span class="co"># 1mm, 2mm, and 3mm. Your list of genotypes can consist of more than 3</span></span>
<span id="cb21-37"><a href="fri-mar-18-evolution-of-body-size.html#cb21-37" aria-hidden="true" tabindex="-1"></a><span class="co"># genotypes, and you can choose different values for your computational experiments.</span></span>
<span id="cb21-38"><a href="fri-mar-18-evolution-of-body-size.html#cb21-38" aria-hidden="true" tabindex="-1"></a>genotypes.list <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb21-39"><a href="fri-mar-18-evolution-of-body-size.html#cb21-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-40"><a href="fri-mar-18-evolution-of-body-size.html#cb21-40" aria-hidden="true" tabindex="-1"></a><span class="co"># The number of genotypes</span></span>
<span id="cb21-41"><a href="fri-mar-18-evolution-of-body-size.html#cb21-41" aria-hidden="true" tabindex="-1"></a>Number.genotypes <span class="ot">=</span> <span class="fu">length</span>(genotypes.list)</span>
<span id="cb21-42"><a href="fri-mar-18-evolution-of-body-size.html#cb21-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-43"><a href="fri-mar-18-evolution-of-body-size.html#cb21-43" aria-hidden="true" tabindex="-1"></a><span class="co"># The different genotypes are assembled into a dataframe where different</span></span>
<span id="cb21-44"><a href="fri-mar-18-evolution-of-body-size.html#cb21-44" aria-hidden="true" tabindex="-1"></a><span class="co"># facts about these genotypes can be added, for example, the development</span></span>
<span id="cb21-45"><a href="fri-mar-18-evolution-of-body-size.html#cb21-45" aria-hidden="true" tabindex="-1"></a><span class="co"># time to reach a particular lenghth at maturity.</span></span>
<span id="cb21-46"><a href="fri-mar-18-evolution-of-body-size.html#cb21-46" aria-hidden="true" tabindex="-1"></a>genotypes <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">id=</span><span class="dv">1</span>,<span class="at">L=</span>genotypes.list[<span class="dv">1</span>])</span>
<span id="cb21-47"><a href="fri-mar-18-evolution-of-body-size.html#cb21-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-48"><a href="fri-mar-18-evolution-of-body-size.html#cb21-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Each genotype is given an &quot;id&quot; named by its position in genotypes.list.</span></span>
<span id="cb21-49"><a href="fri-mar-18-evolution-of-body-size.html#cb21-49" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">2</span>,Number.genotypes)){</span>
<span id="cb21-50"><a href="fri-mar-18-evolution-of-body-size.html#cb21-50" aria-hidden="true" tabindex="-1"></a>  genotypes <span class="ot">=</span> <span class="fu">rbind</span>(genotypes,<span class="fu">c</span>(<span class="at">id =</span> i,<span class="at">L=</span>genotypes.list[i]))</span>
<span id="cb21-51"><a href="fri-mar-18-evolution-of-body-size.html#cb21-51" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-52"><a href="fri-mar-18-evolution-of-body-size.html#cb21-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-53"><a href="fri-mar-18-evolution-of-body-size.html#cb21-53" aria-hidden="true" tabindex="-1"></a><span class="co"># The development time function</span></span>
<span id="cb21-54"><a href="fri-mar-18-evolution-of-body-size.html#cb21-54" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------------------------</span></span>
<span id="cb21-55"><a href="fri-mar-18-evolution-of-body-size.html#cb21-55" aria-hidden="true" tabindex="-1"></a><span class="co"># The time to reach maturity (i.e. be reproductive) is determined by the length</span></span>
<span id="cb21-56"><a href="fri-mar-18-evolution-of-body-size.html#cb21-56" aria-hidden="true" tabindex="-1"></a><span class="co"># at maturity, for example, if the length at maturity is quite large, then</span></span>
<span id="cb21-57"><a href="fri-mar-18-evolution-of-body-size.html#cb21-57" aria-hidden="true" tabindex="-1"></a><span class="co"># it will take more days to reach maturity</span></span>
<span id="cb21-58"><a href="fri-mar-18-evolution-of-body-size.html#cb21-58" aria-hidden="true" tabindex="-1"></a>Development <span class="ot">=</span> <span class="cf">function</span>(L){</span>
<span id="cb21-59"><a href="fri-mar-18-evolution-of-body-size.html#cb21-59" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The graph provided in Fox et al. 2001 Fig. 8.2 was used to estimate the</span></span>
<span id="cb21-60"><a href="fri-mar-18-evolution-of-body-size.html#cb21-60" aria-hidden="true" tabindex="-1"></a>  <span class="co"># parameters d0, d1, and d2.</span></span>
<span id="cb21-61"><a href="fri-mar-18-evolution-of-body-size.html#cb21-61" aria-hidden="true" tabindex="-1"></a>  d0 <span class="ot">=</span><span class="dv">4</span></span>
<span id="cb21-62"><a href="fri-mar-18-evolution-of-body-size.html#cb21-62" aria-hidden="true" tabindex="-1"></a>  d1 <span class="ot">=</span> <span class="fl">2.7</span></span>
<span id="cb21-63"><a href="fri-mar-18-evolution-of-body-size.html#cb21-63" aria-hidden="true" tabindex="-1"></a>  d2 <span class="ot">=</span> <span class="dv">5</span></span>
<span id="cb21-64"><a href="fri-mar-18-evolution-of-body-size.html#cb21-64" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The formula for D, is equation 8.3 on p107 of Fox et al. 2001</span></span>
<span id="cb21-65"><a href="fri-mar-18-evolution-of-body-size.html#cb21-65" aria-hidden="true" tabindex="-1"></a>  D <span class="ot">=</span> d0<span class="sc">*</span>L<span class="sc">^</span>d1 <span class="sc">+</span> d2</span>
<span id="cb21-66"><a href="fri-mar-18-evolution-of-body-size.html#cb21-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(D)</span>
<span id="cb21-67"><a href="fri-mar-18-evolution-of-body-size.html#cb21-67" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-68"><a href="fri-mar-18-evolution-of-body-size.html#cb21-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-69"><a href="fri-mar-18-evolution-of-body-size.html#cb21-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a graph of development time versus thorax length</span></span>
<span id="cb21-70"><a href="fri-mar-18-evolution-of-body-size.html#cb21-70" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------------------</span></span>
<span id="cb21-71"><a href="fri-mar-18-evolution-of-body-size.html#cb21-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a list of thorax lengths at maturity to go on the x-axis</span></span>
<span id="cb21-72"><a href="fri-mar-18-evolution-of-body-size.html#cb21-72" aria-hidden="true" tabindex="-1"></a>Lvec <span class="ot">=</span> <span class="fu">seq</span>(.<span class="dv">55</span>,<span class="dv">2</span>,.<span class="dv">01</span>)</span>
<span id="cb21-73"><a href="fri-mar-18-evolution-of-body-size.html#cb21-73" aria-hidden="true" tabindex="-1"></a><span class="co"># Now make a graph: on the y-axis are the develpment times for different lengths</span></span>
<span id="cb21-74"><a href="fri-mar-18-evolution-of-body-size.html#cb21-74" aria-hidden="true" tabindex="-1"></a><span class="co"># at maturity, on the x-axis are the lengths</span></span>
<span id="cb21-75"><a href="fri-mar-18-evolution-of-body-size.html#cb21-75" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Lvec,<span class="fu">Development</span>(Lvec),<span class="at">typ=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">30</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.55</span>,<span class="dv">2</span>), <span class="at">xlab =</span> <span class="st">&quot;Thorax length, L (mm)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Development time, d(L)&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Fox et al. 2001: Evolutionary ecology, Fig. 8.2&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="fri-mar-18-evolution-of-body-size.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a graph of the proportion of larvae surviving to maturity as a function</span></span>
<span id="cb22-2"><a href="fri-mar-18-evolution-of-body-size.html#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co"># of thorax length at maturity</span></span>
<span id="cb22-3"><a href="fri-mar-18-evolution-of-body-size.html#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------------------------------------------------------</span></span>
<span id="cb22-4"><a href="fri-mar-18-evolution-of-body-size.html#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Every day, there is the same rate of larval mortality, l0, however,</span></span>
<span id="cb22-5"><a href="fri-mar-18-evolution-of-body-size.html#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co"># when the size at maturity is bigger, it takes more days to reach maturity and</span></span>
<span id="cb22-6"><a href="fri-mar-18-evolution-of-body-size.html#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co"># so the probability of dying before reaching the adult stage is higher.</span></span>
<span id="cb22-7"><a href="fri-mar-18-evolution-of-body-size.html#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co"># The equation for the proportion of larvae surviving to adulthood is similiar</span></span>
<span id="cb22-8"><a href="fri-mar-18-evolution-of-body-size.html#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co"># to equation 8.5 in Fox et al. 2001. This graph was used to estimate,</span></span>
<span id="cb22-9"><a href="fri-mar-18-evolution-of-body-size.html#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="co"># l0, based on its agreement with Figure 8.2 in Fox et al. 2001</span></span>
<span id="cb22-10"><a href="fri-mar-18-evolution-of-body-size.html#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Lvec,<span class="fu">exp</span>(<span class="sc">-</span>l0<span class="sc">*</span><span class="fu">Development</span>(Lvec)),<span class="at">typ=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="fl">0.55</span>,<span class="dv">2</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">6</span>), <span class="at">xlab =</span> <span class="st">&quot;Thorax length, L (mm)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Survival from egg to adult&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Fox et al. 2001: Evolutionary ecology, Fig. 8.2&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="fri-mar-18-evolution-of-body-size.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now we calculate the development time for each of the genotypes and add</span></span>
<span id="cb23-2"><a href="fri-mar-18-evolution-of-body-size.html#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># this information to the dataframe summarizing the genotypes</span></span>
<span id="cb23-3"><a href="fri-mar-18-evolution-of-body-size.html#cb23-3" aria-hidden="true" tabindex="-1"></a>Develop.time <span class="ot">=</span> <span class="fu">Development</span>(genotypes<span class="sc">$</span>L)</span>
<span id="cb23-4"><a href="fri-mar-18-evolution-of-body-size.html#cb23-4" aria-hidden="true" tabindex="-1"></a>genotypes <span class="ot">=</span> <span class="fu">cbind</span>(genotypes,Develop.time)</span>
<span id="cb23-5"><a href="fri-mar-18-evolution-of-body-size.html#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="fri-mar-18-evolution-of-body-size.html#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the characteristics of all indviduals in the population initially</span></span>
<span id="cb23-7"><a href="fri-mar-18-evolution-of-body-size.html#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------------------</span></span>
<span id="cb23-8"><a href="fri-mar-18-evolution-of-body-size.html#cb23-8" aria-hidden="true" tabindex="-1"></a>genotype <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb23-9"><a href="fri-mar-18-evolution-of-body-size.html#cb23-9" aria-hidden="true" tabindex="-1"></a>develop.time <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb23-10"><a href="fri-mar-18-evolution-of-body-size.html#cb23-10" aria-hidden="true" tabindex="-1"></a>L <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb23-11"><a href="fri-mar-18-evolution-of-body-size.html#cb23-11" aria-hidden="true" tabindex="-1"></a>age <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb23-12"><a href="fri-mar-18-evolution-of-body-size.html#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="fri-mar-18-evolution-of-body-size.html#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="co"># We begin with all genotypes equally abundant. Run this code below:</span></span>
<span id="cb23-14"><a href="fri-mar-18-evolution-of-body-size.html#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>,Number.genotypes)){</span>
<span id="cb23-15"><a href="fri-mar-18-evolution-of-body-size.html#cb23-15" aria-hidden="true" tabindex="-1"></a>  genotype <span class="ot">=</span> <span class="fu">c</span>(genotype,<span class="fu">rep</span>(i,Popn.Size<span class="sc">/</span>Number.genotypes))</span>
<span id="cb23-16"><a href="fri-mar-18-evolution-of-body-size.html#cb23-16" aria-hidden="true" tabindex="-1"></a>  develop.time<span class="ot">=</span><span class="fu">c</span>(develop.time,<span class="fu">rep</span>(genotypes<span class="sc">$</span>Develop.time[i],Popn.Size<span class="sc">/</span>Number.genotypes))</span>
<span id="cb23-17"><a href="fri-mar-18-evolution-of-body-size.html#cb23-17" aria-hidden="true" tabindex="-1"></a>  L <span class="ot">=</span> <span class="fu">c</span>(L,<span class="fu">rep</span>(genotypes<span class="sc">$</span>Develop.time[i],Popn.Size<span class="sc">/</span>Number.genotypes))</span>
<span id="cb23-18"><a href="fri-mar-18-evolution-of-body-size.html#cb23-18" aria-hidden="true" tabindex="-1"></a>  age<span class="ot">=</span><span class="fu">c</span>(age,<span class="fu">rep</span>(<span class="dv">0</span>,Popn.Size<span class="sc">/</span>Number.genotypes))</span>
<span id="cb23-19"><a href="fri-mar-18-evolution-of-body-size.html#cb23-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-20"><a href="fri-mar-18-evolution-of-body-size.html#cb23-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-21"><a href="fri-mar-18-evolution-of-body-size.html#cb23-21" aria-hidden="true" tabindex="-1"></a><span class="co"># The loop above is used to create a dataframe &quot;Popn&quot; that lists all the</span></span>
<span id="cb23-22"><a href="fri-mar-18-evolution-of-body-size.html#cb23-22" aria-hidden="true" tabindex="-1"></a><span class="co"># individuals in the population, their genotype, their age, and the aspects</span></span>
<span id="cb23-23"><a href="fri-mar-18-evolution-of-body-size.html#cb23-23" aria-hidden="true" tabindex="-1"></a><span class="co"># of life history that derive from size at maturity, L, i.e. development time</span></span>
<span id="cb23-24"><a href="fri-mar-18-evolution-of-body-size.html#cb23-24" aria-hidden="true" tabindex="-1"></a>Popn <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(<span class="at">genotype=</span>genotype,<span class="at">age=</span>age,<span class="at">L=</span>L,develop.time))</span>
<span id="cb23-25"><a href="fri-mar-18-evolution-of-body-size.html#cb23-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-26"><a href="fri-mar-18-evolution-of-body-size.html#cb23-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Fecundity is a function of body size at maturity and age:</span></span>
<span id="cb23-27"><a href="fri-mar-18-evolution-of-body-size.html#cb23-27" aria-hidden="true" tabindex="-1"></a>Fecundity <span class="ot">=</span> <span class="cf">function</span>(a,L){</span>
<span id="cb23-28"><a href="fri-mar-18-evolution-of-body-size.html#cb23-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The parameters weren&#39;t given in Fox et al., so I did a bunch of algebra and</span></span>
<span id="cb23-29"><a href="fri-mar-18-evolution-of-body-size.html#cb23-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># graphing to figure out what the parameters could be to reproduce Fig. 8.2</span></span>
<span id="cb23-30"><a href="fri-mar-18-evolution-of-body-size.html#cb23-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># in Fox et al. I assumed that small implied L = 0.6mm and large implied L = 1.6mm.</span></span>
<span id="cb23-31"><a href="fri-mar-18-evolution-of-body-size.html#cb23-31" aria-hidden="true" tabindex="-1"></a>  m1 <span class="ot">=</span> .<span class="dv">45</span></span>
<span id="cb23-32"><a href="fri-mar-18-evolution-of-body-size.html#cb23-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># m2: x-intercept</span></span>
<span id="cb23-33"><a href="fri-mar-18-evolution-of-body-size.html#cb23-33" aria-hidden="true" tabindex="-1"></a>  m2 <span class="ot">=</span> <span class="dv">3</span></span>
<span id="cb23-34"><a href="fri-mar-18-evolution-of-body-size.html#cb23-34" aria-hidden="true" tabindex="-1"></a>  m3 <span class="ot">=</span> .<span class="dv">15</span></span>
<span id="cb23-35"><a href="fri-mar-18-evolution-of-body-size.html#cb23-35" aria-hidden="true" tabindex="-1"></a>  m5 <span class="ot">=</span> .<span class="dv">8</span></span>
<span id="cb23-36"><a href="fri-mar-18-evolution-of-body-size.html#cb23-36" aria-hidden="true" tabindex="-1"></a>  m4 <span class="ot">=</span> <span class="dv">250</span></span>
<span id="cb23-37"><a href="fri-mar-18-evolution-of-body-size.html#cb23-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># m0 is described in the text below equation 8.4</span></span>
<span id="cb23-38"><a href="fri-mar-18-evolution-of-body-size.html#cb23-38" aria-hidden="true" tabindex="-1"></a>  m0 <span class="ot">=</span> m4<span class="sc">*</span>L<span class="sc">^</span>m5</span>
<span id="cb23-39"><a href="fri-mar-18-evolution-of-body-size.html#cb23-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># m is equation 8.4 on p107</span></span>
<span id="cb23-40"><a href="fri-mar-18-evolution-of-body-size.html#cb23-40" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">=</span> m0<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>m1<span class="sc">*</span>(a<span class="sc">-</span>m2)))<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>m3<span class="sc">*</span>a)</span>
<span id="cb23-41"><a href="fri-mar-18-evolution-of-body-size.html#cb23-41" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fecundity should not be less than zero</span></span>
<span id="cb23-42"><a href="fri-mar-18-evolution-of-body-size.html#cb23-42" aria-hidden="true" tabindex="-1"></a>  m[m<span class="sc">&lt;</span><span class="dv">0</span>] <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb23-43"><a href="fri-mar-18-evolution-of-body-size.html#cb23-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(m)</span>
<span id="cb23-44"><a href="fri-mar-18-evolution-of-body-size.html#cb23-44" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-45"><a href="fri-mar-18-evolution-of-body-size.html#cb23-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-46"><a href="fri-mar-18-evolution-of-body-size.html#cb23-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Graph age (days) versus female eggs</span></span>
<span id="cb23-47"><a href="fri-mar-18-evolution-of-body-size.html#cb23-47" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------</span></span>
<span id="cb23-48"><a href="fri-mar-18-evolution-of-body-size.html#cb23-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Vector of ages to plot on the x-axis</span></span>
<span id="cb23-49"><a href="fri-mar-18-evolution-of-body-size.html#cb23-49" aria-hidden="true" tabindex="-1"></a>avec <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">20</span>,.<span class="dv">1</span>)</span>
<span id="cb23-50"><a href="fri-mar-18-evolution-of-body-size.html#cb23-50" aria-hidden="true" tabindex="-1"></a><span class="co"># The values on the y-axis are given by evaluating the Fecundity function</span></span>
<span id="cb23-51"><a href="fri-mar-18-evolution-of-body-size.html#cb23-51" aria-hidden="true" tabindex="-1"></a><span class="co"># for L = 0.6mm (small) and L=1.6mm (large)</span></span>
<span id="cb23-52"><a href="fri-mar-18-evolution-of-body-size.html#cb23-52" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(avec,<span class="fu">Fecundity</span>(avec,<span class="fl">0.6</span>), <span class="at">typ=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>,<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">120</span>), <span class="at">xlab =</span> <span class="st">&quot;Age (days since eclosion)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Female eggs, m(x)&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Fox et al. 2001: Evolutionary ecology, Fig. 8.2&quot;</span>)</span>
<span id="cb23-53"><a href="fri-mar-18-evolution-of-body-size.html#cb23-53" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(avec, <span class="fu">Fecundity</span>(avec,<span class="fl">1.6</span>), <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="fri-mar-18-evolution-of-body-size.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For the population dynamics, we assume that at each time step one individual dies</span></span>
<span id="cb24-2"><a href="fri-mar-18-evolution-of-body-size.html#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co"># and one individual reproduces making an offspring with the same genotype but</span></span>
<span id="cb24-3"><a href="fri-mar-18-evolution-of-body-size.html#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co"># with age 0. This is called the DB model (death then birth) and I have assumed</span></span>
<span id="cb24-4"><a href="fri-mar-18-evolution-of-body-size.html#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># the population has a fixed size (if at least one individual can reproduce).</span></span>
<span id="cb24-5"><a href="fri-mar-18-evolution-of-body-size.html#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Every inidividual in the population gets a &quot;score&quot; for their chance of dying:</span></span>
<span id="cb24-6"><a href="fri-mar-18-evolution-of-body-size.html#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co"># l0 is assigned to all larvae, and l1 to all adults. Any individual dies in</span></span>
<span id="cb24-7"><a href="fri-mar-18-evolution-of-body-size.html#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co"># proportion to its &quot;dscore&quot; based on these mortality rates.</span></span>
<span id="cb24-8"><a href="fri-mar-18-evolution-of-body-size.html#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="fri-mar-18-evolution-of-body-size.html#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Setting dscore and bscore = age is preallocation to get the correct size, since bscore</span></span>
<span id="cb24-10"><a href="fri-mar-18-evolution-of-body-size.html#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="co"># and dscore will have the same length as the number of individuals in the population.</span></span>
<span id="cb24-11"><a href="fri-mar-18-evolution-of-body-size.html#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="fri-mar-18-evolution-of-body-size.html#cb24-12" aria-hidden="true" tabindex="-1"></a>dscore <span class="ot">=</span> age</span>
<span id="cb24-13"><a href="fri-mar-18-evolution-of-body-size.html#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="fri-mar-18-evolution-of-body-size.html#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Each individual is assinged a &quot;bscore&quot; that reflects their chance of reproducing.</span></span>
<span id="cb24-15"><a href="fri-mar-18-evolution-of-body-size.html#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="co"># If the individual has yet to reach reproductive age, then bscore is 0 for them. For all</span></span>
<span id="cb24-16"><a href="fri-mar-18-evolution-of-body-size.html#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="co"># individuals that have reach reproductive age, their &quot;bscore&quot; is in proportion to</span></span>
<span id="cb24-17"><a href="fri-mar-18-evolution-of-body-size.html#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="co"># their fecundity as determined by the Fecundity() function: depending on their</span></span>
<span id="cb24-18"><a href="fri-mar-18-evolution-of-body-size.html#cb24-18" aria-hidden="true" tabindex="-1"></a><span class="co"># age and size at maturity</span></span>
<span id="cb24-19"><a href="fri-mar-18-evolution-of-body-size.html#cb24-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-20"><a href="fri-mar-18-evolution-of-body-size.html#cb24-20" aria-hidden="true" tabindex="-1"></a>bscore <span class="ot">=</span> age</span>
<span id="cb24-21"><a href="fri-mar-18-evolution-of-body-size.html#cb24-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-22"><a href="fri-mar-18-evolution-of-body-size.html#cb24-22" aria-hidden="true" tabindex="-1"></a><span class="co"># At each time step, we count all the individuals with a particular</span></span>
<span id="cb24-23"><a href="fri-mar-18-evolution-of-body-size.html#cb24-23" aria-hidden="true" tabindex="-1"></a><span class="co"># genotype, and record these counts in a matrix &quot;Number&quot;. Below is</span></span>
<span id="cb24-24"><a href="fri-mar-18-evolution-of-body-size.html#cb24-24" aria-hidden="true" tabindex="-1"></a><span class="co"># preallocation, and setting the correct value at t=0 before we let the dynamics</span></span>
<span id="cb24-25"><a href="fri-mar-18-evolution-of-body-size.html#cb24-25" aria-hidden="true" tabindex="-1"></a><span class="co"># evolve over time.</span></span>
<span id="cb24-26"><a href="fri-mar-18-evolution-of-body-size.html#cb24-26" aria-hidden="true" tabindex="-1"></a>Number <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>,total.time<span class="sc">+</span><span class="dv">1</span>,<span class="dv">1</span><span class="sc">+</span>Number.genotypes)</span>
<span id="cb24-27"><a href="fri-mar-18-evolution-of-body-size.html#cb24-27" aria-hidden="true" tabindex="-1"></a>Number[<span class="dv">1</span>,]<span class="ot">=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">t</span>(<span class="fu">unname</span>(<span class="fu">table</span>(Popn<span class="sc">$</span>genotype))))</span>
<span id="cb24-28"><a href="fri-mar-18-evolution-of-body-size.html#cb24-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-29"><a href="fri-mar-18-evolution-of-body-size.html#cb24-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Before we enter the loop, time is set equal to 0. In the loop, Time will</span></span>
<span id="cb24-30"><a href="fri-mar-18-evolution-of-body-size.html#cb24-30" aria-hidden="true" tabindex="-1"></a><span class="co"># be incremented with every iteration of the loop</span></span>
<span id="cb24-31"><a href="fri-mar-18-evolution-of-body-size.html#cb24-31" aria-hidden="true" tabindex="-1"></a>Time <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb24-32"><a href="fri-mar-18-evolution-of-body-size.html#cb24-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-33"><a href="fri-mar-18-evolution-of-body-size.html#cb24-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the temporal dynamics to reveal the changes in genotype</span></span>
<span id="cb24-34"><a href="fri-mar-18-evolution-of-body-size.html#cb24-34" aria-hidden="true" tabindex="-1"></a><span class="co"># frequency</span></span>
<span id="cb24-35"><a href="fri-mar-18-evolution-of-body-size.html#cb24-35" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(t <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>,total.time)){</span>
<span id="cb24-36"><a href="fri-mar-18-evolution-of-body-size.html#cb24-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Each individual has a corresponding dscore, based on whether the</span></span>
<span id="cb24-37"><a href="fri-mar-18-evolution-of-body-size.html#cb24-37" aria-hidden="true" tabindex="-1"></a><span class="co"># individual is a larvae or an adult:</span></span>
<span id="cb24-38"><a href="fri-mar-18-evolution-of-body-size.html#cb24-38" aria-hidden="true" tabindex="-1"></a>dscore[Popn<span class="sc">$</span>age<span class="sc">&gt;=</span>Popn<span class="sc">$</span>develop.time] <span class="ot">=</span> l1</span>
<span id="cb24-39"><a href="fri-mar-18-evolution-of-body-size.html#cb24-39" aria-hidden="true" tabindex="-1"></a>dscore[Popn<span class="sc">$</span>age<span class="sc">&lt;</span>Popn<span class="sc">$</span>develop.time] <span class="ot">=</span> l0</span>
<span id="cb24-40"><a href="fri-mar-18-evolution-of-body-size.html#cb24-40" aria-hidden="true" tabindex="-1"></a><span class="co"># cum.dscore: divide up a number line into intervals with length proportional to the</span></span>
<span id="cb24-41"><a href="fri-mar-18-evolution-of-body-size.html#cb24-41" aria-hidden="true" tabindex="-1"></a><span class="co"># dscore for each individual</span></span>
<span id="cb24-42"><a href="fri-mar-18-evolution-of-body-size.html#cb24-42" aria-hidden="true" tabindex="-1"></a>cum.dscore <span class="ot">=</span> <span class="fu">cumsum</span>(dscore)</span>
<span id="cb24-43"><a href="fri-mar-18-evolution-of-body-size.html#cb24-43" aria-hidden="true" tabindex="-1"></a><span class="co"># r1: choose a random number. This random number corresponds to an interval of cum.dscore associated</span></span>
<span id="cb24-44"><a href="fri-mar-18-evolution-of-body-size.html#cb24-44" aria-hidden="true" tabindex="-1"></a><span class="co"># with a given individual. Based on this random number an individual is selected to</span></span>
<span id="cb24-45"><a href="fri-mar-18-evolution-of-body-size.html#cb24-45" aria-hidden="true" tabindex="-1"></a><span class="co"># die: the individual that dies is randomly choosen, but in proportion its mortality rate.</span></span>
<span id="cb24-46"><a href="fri-mar-18-evolution-of-body-size.html#cb24-46" aria-hidden="true" tabindex="-1"></a>r1 <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="dv">0</span>, cum.dscore[<span class="fu">length</span>(Popn[,<span class="dv">1</span>])])</span>
<span id="cb24-47"><a href="fri-mar-18-evolution-of-body-size.html#cb24-47" aria-hidden="true" tabindex="-1"></a><span class="co"># ind.d: identifies that row position in the Popn matrix of the individual that will die.</span></span>
<span id="cb24-48"><a href="fri-mar-18-evolution-of-body-size.html#cb24-48" aria-hidden="true" tabindex="-1"></a>ind.d <span class="ot">=</span> <span class="fu">min</span>(<span class="fu">which</span>(cum.dscore<span class="sc">&gt;</span>r1))</span>
<span id="cb24-49"><a href="fri-mar-18-evolution-of-body-size.html#cb24-49" aria-hidden="true" tabindex="-1"></a><span class="co"># The line of code below removes the individual that experiences the mortality from the population.</span></span>
<span id="cb24-50"><a href="fri-mar-18-evolution-of-body-size.html#cb24-50" aria-hidden="true" tabindex="-1"></a>Popn <span class="ot">=</span> Popn[<span class="sc">-</span>ind.d,]</span>
<span id="cb24-51"><a href="fri-mar-18-evolution-of-body-size.html#cb24-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Below, we re-index the rows so there is not a missing index value.</span></span>
<span id="cb24-52"><a href="fri-mar-18-evolution-of-body-size.html#cb24-52" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(Popn) <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="fu">length</span>(Popn[,<span class="dv">1</span>]))</span>
<span id="cb24-53"><a href="fri-mar-18-evolution-of-body-size.html#cb24-53" aria-hidden="true" tabindex="-1"></a><span class="co"># bscore: bscore is zero....</span></span>
<span id="cb24-54"><a href="fri-mar-18-evolution-of-body-size.html#cb24-54" aria-hidden="true" tabindex="-1"></a>bscore <span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">length</span>(Popn[,<span class="dv">1</span>]))</span>
<span id="cb24-55"><a href="fri-mar-18-evolution-of-body-size.html#cb24-55" aria-hidden="true" tabindex="-1"></a><span class="co"># ... unless the individual is an adult. Being an adult is defined as having an age greater than</span></span>
<span id="cb24-56"><a href="fri-mar-18-evolution-of-body-size.html#cb24-56" aria-hidden="true" tabindex="-1"></a><span class="co"># the development time needed to reach maturity. Given that an individual is an adult</span></span>
<span id="cb24-57"><a href="fri-mar-18-evolution-of-body-size.html#cb24-57" aria-hidden="true" tabindex="-1"></a><span class="co"># their fecundity score is given by the Fecundity() function, which depends on the individuals age and size.</span></span>
<span id="cb24-58"><a href="fri-mar-18-evolution-of-body-size.html#cb24-58" aria-hidden="true" tabindex="-1"></a>bscore[Popn<span class="sc">$</span>age<span class="sc">&gt;=</span>Popn<span class="sc">$</span>develop.time]<span class="ot">=</span><span class="fu">Fecundity</span>(Popn<span class="sc">$</span>age[Popn<span class="sc">$</span>age<span class="sc">&gt;=</span>Popn<span class="sc">$</span>develop.time],Popn<span class="sc">$</span>L[Popn<span class="sc">$</span>age<span class="sc">&gt;=</span>Popn<span class="sc">$</span>develop.time])</span>
<span id="cb24-59"><a href="fri-mar-18-evolution-of-body-size.html#cb24-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-60"><a href="fri-mar-18-evolution-of-body-size.html#cb24-60" aria-hidden="true" tabindex="-1"></a><span class="co"># cum.bscore: break-up a number line so that intervals are proportional to</span></span>
<span id="cb24-61"><a href="fri-mar-18-evolution-of-body-size.html#cb24-61" aria-hidden="true" tabindex="-1"></a><span class="co"># the bscore</span></span>
<span id="cb24-62"><a href="fri-mar-18-evolution-of-body-size.html#cb24-62" aria-hidden="true" tabindex="-1"></a>cum.bscore <span class="ot">=</span> <span class="fu">cumsum</span>(bscore)</span>
<span id="cb24-63"><a href="fri-mar-18-evolution-of-body-size.html#cb24-63" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(cum.bscore[<span class="fu">length</span>(Popn[,<span class="dv">1</span>])]<span class="sc">&gt;</span><span class="dv">0</span>){</span>
<span id="cb24-64"><a href="fri-mar-18-evolution-of-body-size.html#cb24-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Choose a random number to select the individual that reproduces, in proportion to their bscore.</span></span>
<span id="cb24-65"><a href="fri-mar-18-evolution-of-body-size.html#cb24-65" aria-hidden="true" tabindex="-1"></a>r1 <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="dv">0</span>, cum.bscore[<span class="fu">length</span>(Popn[,<span class="dv">1</span>])])</span>
<span id="cb24-66"><a href="fri-mar-18-evolution-of-body-size.html#cb24-66" aria-hidden="true" tabindex="-1"></a><span class="co"># ind.b: the row corresponding the individual that is selected to reproduce</span></span>
<span id="cb24-67"><a href="fri-mar-18-evolution-of-body-size.html#cb24-67" aria-hidden="true" tabindex="-1"></a>ind.b <span class="ot">=</span> <span class="fu">min</span>(<span class="fu">which</span>(cum.bscore<span class="sc">&gt;</span>r1))</span>
<span id="cb24-68"><a href="fri-mar-18-evolution-of-body-size.html#cb24-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new individual with: the same genotype id as the parent; age = 0; the same length at maturity</span></span>
<span id="cb24-69"><a href="fri-mar-18-evolution-of-body-size.html#cb24-69" aria-hidden="true" tabindex="-1"></a><span class="co"># as the parent; and the same development time as the parent.</span></span>
<span id="cb24-70"><a href="fri-mar-18-evolution-of-body-size.html#cb24-70" aria-hidden="true" tabindex="-1"></a>new.ind <span class="ot">=</span> <span class="fu">c</span>(Popn<span class="sc">$</span>genotype[ind.b], <span class="dv">0</span>,Popn<span class="sc">$</span>L[ind.b],Popn<span class="sc">$</span>develop.time[ind.b])</span>
<span id="cb24-71"><a href="fri-mar-18-evolution-of-body-size.html#cb24-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the new individual to the population</span></span>
<span id="cb24-72"><a href="fri-mar-18-evolution-of-body-size.html#cb24-72" aria-hidden="true" tabindex="-1"></a>Popn <span class="ot">=</span> <span class="fu">rbind</span>(Popn,new.ind)</span>
<span id="cb24-73"><a href="fri-mar-18-evolution-of-body-size.html#cb24-73" aria-hidden="true" tabindex="-1"></a><span class="co"># Fix up the row index names</span></span>
<span id="cb24-74"><a href="fri-mar-18-evolution-of-body-size.html#cb24-74" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(Popn) <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="fu">length</span>(Popn[,<span class="dv">1</span>]))</span>
<span id="cb24-75"><a href="fri-mar-18-evolution-of-body-size.html#cb24-75" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-76"><a href="fri-mar-18-evolution-of-body-size.html#cb24-76" aria-hidden="true" tabindex="-1"></a><span class="co"># For one iteration of the loop, how much does time increment? One idea</span></span>
<span id="cb24-77"><a href="fri-mar-18-evolution-of-body-size.html#cb24-77" aria-hidden="true" tabindex="-1"></a><span class="co"># was to base this on the time for one mortality to occur, which is given</span></span>
<span id="cb24-78"><a href="fri-mar-18-evolution-of-body-size.html#cb24-78" aria-hidden="true" tabindex="-1"></a><span class="co"># by under a Gillespie algorithm implementation, however, this seemed</span></span>
<span id="cb24-79"><a href="fri-mar-18-evolution-of-body-size.html#cb24-79" aria-hidden="true" tabindex="-1"></a><span class="co"># to give the evolution of very small L, so I commented it out.</span></span>
<span id="cb24-80"><a href="fri-mar-18-evolution-of-body-size.html#cb24-80" aria-hidden="true" tabindex="-1"></a><span class="co"># dt = -log(runif(1))/cum.dscore[length(Popn[,1])]</span></span>
<span id="cb24-81"><a href="fri-mar-18-evolution-of-body-size.html#cb24-81" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s assume that each iteration of the loop corresponds to one day</span></span>
<span id="cb24-82"><a href="fri-mar-18-evolution-of-body-size.html#cb24-82" aria-hidden="true" tabindex="-1"></a>dt<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb24-83"><a href="fri-mar-18-evolution-of-body-size.html#cb24-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-84"><a href="fri-mar-18-evolution-of-body-size.html#cb24-84" aria-hidden="true" tabindex="-1"></a><span class="co"># The new value of Time (upon the completion of this iteration of the loop)</span></span>
<span id="cb24-85"><a href="fri-mar-18-evolution-of-body-size.html#cb24-85" aria-hidden="true" tabindex="-1"></a><span class="co"># is the old value of Time (from the previous iteration of the loop) + dt.</span></span>
<span id="cb24-86"><a href="fri-mar-18-evolution-of-body-size.html#cb24-86" aria-hidden="true" tabindex="-1"></a>Time <span class="ot">=</span> Time<span class="sc">+</span>dt</span>
<span id="cb24-87"><a href="fri-mar-18-evolution-of-body-size.html#cb24-87" aria-hidden="true" tabindex="-1"></a><span class="co"># As time progresses, individuals age too.</span></span>
<span id="cb24-88"><a href="fri-mar-18-evolution-of-body-size.html#cb24-88" aria-hidden="true" tabindex="-1"></a>Popn<span class="sc">$</span>age <span class="ot">=</span> Popn<span class="sc">$</span>age<span class="sc">+</span>dt</span>
<span id="cb24-89"><a href="fri-mar-18-evolution-of-body-size.html#cb24-89" aria-hidden="true" tabindex="-1"></a><span class="co"># Count up the number of individuals with each genotype currently in the population.</span></span>
<span id="cb24-90"><a href="fri-mar-18-evolution-of-body-size.html#cb24-90" aria-hidden="true" tabindex="-1"></a><span class="co"># the table() function gives the counts that are non-zero and so the role of the first</span></span>
<span id="cb24-91"><a href="fri-mar-18-evolution-of-body-size.html#cb24-91" aria-hidden="true" tabindex="-1"></a><span class="co"># instance of &quot;genotypes.count&quot; is to assign 0 for the all the genotypes that are not</span></span>
<span id="cb24-92"><a href="fri-mar-18-evolution-of-body-size.html#cb24-92" aria-hidden="true" tabindex="-1"></a><span class="co"># observed.</span></span>
<span id="cb24-93"><a href="fri-mar-18-evolution-of-body-size.html#cb24-93" aria-hidden="true" tabindex="-1"></a>genotypes.count <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span>,Number.genotypes)</span>
<span id="cb24-94"><a href="fri-mar-18-evolution-of-body-size.html#cb24-94" aria-hidden="true" tabindex="-1"></a>genotypes.summary <span class="ot">=</span> <span class="fu">table</span>(Popn<span class="sc">$</span>genotype)</span>
<span id="cb24-95"><a href="fri-mar-18-evolution-of-body-size.html#cb24-95" aria-hidden="true" tabindex="-1"></a>genotypes.count[<span class="fu">as.numeric</span>(<span class="fu">names</span>(genotypes.summary))]<span class="ot">=</span><span class="fu">unname</span>(genotypes.summary)</span>
<span id="cb24-96"><a href="fri-mar-18-evolution-of-body-size.html#cb24-96" aria-hidden="true" tabindex="-1"></a><span class="co"># Record the time, and the number of individuals with each genotype.</span></span>
<span id="cb24-97"><a href="fri-mar-18-evolution-of-body-size.html#cb24-97" aria-hidden="true" tabindex="-1"></a>Number[t<span class="sc">+</span><span class="dv">1</span>,] <span class="ot">=</span> <span class="fu">c</span>(Time, genotypes.count)</span>
<span id="cb24-98"><a href="fri-mar-18-evolution-of-body-size.html#cb24-98" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-99"><a href="fri-mar-18-evolution-of-body-size.html#cb24-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-100"><a href="fri-mar-18-evolution-of-body-size.html#cb24-100" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the results</span></span>
<span id="cb24-101"><a href="fri-mar-18-evolution-of-body-size.html#cb24-101" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------</span></span>
<span id="cb24-102"><a href="fri-mar-18-evolution-of-body-size.html#cb24-102" aria-hidden="true" tabindex="-1"></a><span class="co"># Fix the color palette, so that we can make a legend that will be</span></span>
<span id="cb24-103"><a href="fri-mar-18-evolution-of-body-size.html#cb24-103" aria-hidden="true" tabindex="-1"></a><span class="co"># correct for a variable number of genotypes</span></span>
<span id="cb24-104"><a href="fri-mar-18-evolution-of-body-size.html#cb24-104" aria-hidden="true" tabindex="-1"></a>Colours <span class="ot">=</span> <span class="fu">viridis</span>(Number.genotypes)</span>
<span id="cb24-105"><a href="fri-mar-18-evolution-of-body-size.html#cb24-105" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Number[,<span class="dv">1</span>], Number[,<span class="dv">2</span>], <span class="at">typ=</span><span class="st">&quot;l&quot;</span>, <span class="at">col =</span> Colours[<span class="dv">1</span>], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fu">min</span>(Number[,<span class="dv">2</span><span class="sc">:</span>(Number.genotypes<span class="sc">+</span><span class="dv">1</span>)])<span class="sc">/</span><span class="dv">2</span>,<span class="fu">max</span>(Number[,<span class="dv">2</span><span class="sc">:</span>(Number.genotypes<span class="sc">+</span><span class="dv">1</span>)])), <span class="at">xlab =</span> <span class="st">&quot;time, days&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;no. of ind. with genotype i&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Evolution of body size at maturity&quot;</span>)</span>
<span id="cb24-106"><a href="fri-mar-18-evolution-of-body-size.html#cb24-106" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">2</span>,Number.genotypes)){</span>
<span id="cb24-107"><a href="fri-mar-18-evolution-of-body-size.html#cb24-107" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(Number[,<span class="dv">1</span>], Number[,i<span class="sc">+</span><span class="dv">1</span>], <span class="at">typ=</span><span class="st">&quot;l&quot;</span>, <span class="at">col =</span> Colours[i])</span>
<span id="cb24-108"><a href="fri-mar-18-evolution-of-body-size.html#cb24-108" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-109"><a href="fri-mar-18-evolution-of-body-size.html#cb24-109" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">xpd=</span><span class="cn">TRUE</span>)</span>
<span id="cb24-110"><a href="fri-mar-18-evolution-of-body-size.html#cb24-110" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="at">legend =</span> genotypes<span class="sc">$</span>L, <span class="at">col=</span>Colours, <span class="at">lty =</span> <span class="fu">rep</span>(<span class="dv">1</span>,Number.genotypes),<span class="at">box.lwd =</span> <span class="dv">0</span>)</span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="fri-mar-18-evolution-of-body-size.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SOME NOTES</span></span>
<span id="cb25-2"><a href="fri-mar-18-evolution-of-body-size.html#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------</span></span>
<span id="cb25-3"><a href="fri-mar-18-evolution-of-body-size.html#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. The outcome of the evolutionary dynamics are quite sensitive to the choice of</span></span>
<span id="cb25-4"><a href="fri-mar-18-evolution-of-body-size.html#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   dt, which was made arbitrarily.</span></span>
<span id="cb25-5"><a href="fri-mar-18-evolution-of-body-size.html#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. The initial condition starts with only larvae, and so for the first few iterations</span></span>
<span id="cb25-6"><a href="fri-mar-18-evolution-of-body-size.html#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="co">#    of the loop there is no reproduction. During this time, the population decreases in size</span></span>
<span id="cb25-7"><a href="fri-mar-18-evolution-of-body-size.html#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co">#    and it is only once at least one individual is an adult, that reproduction begins and</span></span>
<span id="cb25-8"><a href="fri-mar-18-evolution-of-body-size.html#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="co">#    the population size stabilizes. Therefore, whatever the value of &quot;Popn.Size&quot; the population</span></span>
<span id="cb25-9"><a href="fri-mar-18-evolution-of-body-size.html#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="co">#    will actually stabilize at a value a bit lower than this.</span></span>
<span id="cb25-10"><a href="fri-mar-18-evolution-of-body-size.html#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. The graph shows the length at maturity. If you would like to know the development</span></span>
<span id="cb25-11"><a href="fri-mar-18-evolution-of-body-size.html#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="co">#    time, you need to type &gt; Development(L0) into the console, where L0 is a number</span></span>
<span id="cb25-12"><a href="fri-mar-18-evolution-of-body-size.html#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="co">#    corresponding to the length at maturity you want to know the corresponding development</span></span>
<span id="cb25-13"><a href="fri-mar-18-evolution-of-body-size.html#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="co">#    time for.</span></span>
<span id="cb25-14"><a href="fri-mar-18-evolution-of-body-size.html#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. You can make a graph for &quot;Female eggs, m(x)&quot; for a given length maturity, L0 by</span></span>
<span id="cb25-15"><a href="fri-mar-18-evolution-of-body-size.html#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="co">#    using the following commands:</span></span>
<span id="cb25-16"><a href="fri-mar-18-evolution-of-body-size.html#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="co">#  avec = seq(0,20,.1)</span></span>
<span id="cb25-17"><a href="fri-mar-18-evolution-of-body-size.html#cb25-17" aria-hidden="true" tabindex="-1"></a><span class="co">#  plot(avec,Fecundity(avec,L0), typ=&quot;l&quot;, lwd=3,ylim = c(0,120), xlab = &quot;Age (days since eclosion)&quot;, ylab = &quot;Female eggs, m(x)&quot;)</span></span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="thurs-mar-17-lab-5-final-project-proposal.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="tues-mar-21-work-on-lab-5final-project-catch-up-day.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
